{"code":"import { Contract } from '@ethersproject/contracts';\r\nimport { Buffer } from 'buffer/';\r\nimport { fetch, resolveURI } from '../utils';\r\nconst abi = [\r\n    'function tokenURI(uint256 tokenId) external view returns (string memory)',\r\n    'function ownerOf(uint256 tokenId) public view returns (address)',\r\n];\r\nexport default class ERC721 {\r\n    async getMetadata(provider, ownerAddress, contractAddress, tokenID) {\r\n        const contract = new Contract(contractAddress, abi, provider);\r\n        const [tokenURI, owner] = await Promise.all([\r\n            contract.tokenURI(tokenID),\r\n            ownerAddress && contract.ownerOf(tokenID),\r\n        ]);\r\n        // if user has valid address and if owner of the nft matches with the owner address\r\n        const isOwner = !!(ownerAddress && owner.toLowerCase() === ownerAddress.toLowerCase());\r\n        const { uri: resolvedURI, isOnChain, isEncoded } = resolveURI(tokenURI);\r\n        let _resolvedUri = resolvedURI;\r\n        if (isOnChain) {\r\n            if (isEncoded) {\r\n                _resolvedUri = Buffer.from(resolvedURI.replace('data:application/json;base64,', ''), 'base64').toString();\r\n            }\r\n            return JSON.parse(_resolvedUri);\r\n        }\r\n        const response = await fetch(resolvedURI.replace(/(?:0x)?{id}/, tokenID));\r\n        const metadata = await response?.data;\r\n        return { ...metadata, is_owner: isOwner };\r\n    }\r\n}\r\n//# sourceMappingURL=erc721.js.map","references":["/Users/kames/workspace/soulcialites/web3-citizen/node_modules/.pnpm/@ethersproject+providers@5.6.8/node_modules/@ethersproject/providers/lib/index.d.ts","/Users/kames/workspace/soulcialites/web3-citizen/node_modules/.pnpm/@ethersproject+contracts@5.6.2/node_modules/@ethersproject/contracts/lib/index.d.ts","/Users/kames/workspace/soulcialites/web3-citizen/node_modules/.pnpm/buffer@6.0.3/node_modules/buffer/index.d.ts","/Users/kames/workspace/soulcialites/web3-citizen/packages/ens-wagmi/src/utils/utils.ts"],"map":"{\"version\":3,\"file\":\"erc721.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/utils/specs/erc721.ts\"],\"names\":[],\"mappings\":\"AACA,OAAO,EAAE,QAAQ,EAAE,MAAM,0BAA0B,CAAC;AACpD,OAAO,EAAE,MAAM,EAAE,MAAM,SAAS,CAAC;AACjC,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE,MAAM,UAAU,CAAC;AAE7C,MAAM,GAAG,GAAG;IACV,0EAA0E;IAC1E,iEAAiE;CAClE,CAAC;AAEF,MAAM,CAAC,OAAO,OAAO,MAAM;IACzB,KAAK,CAAC,WAAW,CACf,QAAsB,EACtB,YAAuC,EACvC,eAAuB,EACvB,OAAe;QAEf,MAAM,QAAQ,GAAG,IAAI,QAAQ,CAAC,eAAe,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC;QAC9D,MAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;YAC1C,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC;YAC1B,YAAY,IAAI,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC;SAC1C,CAAC,CAAC;QACH,mFAAmF;QACnF,MAAM,OAAO,GAAG,CAAC,CAAC,CAChB,YAAY,IAAI,KAAK,CAAC,WAAW,EAAE,KAAK,YAAY,CAAC,WAAW,EAAE,CACnE,CAAC;QAEF,MAAM,EAAE,GAAG,EAAE,WAAW,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC;QACxE,IAAI,YAAY,GAAG,WAAW,CAAC;QAC/B,IAAI,SAAS,EAAE;YACb,IAAI,SAAS,EAAE;gBACb,YAAY,GAAG,MAAM,CAAC,IAAI,CACxB,WAAW,CAAC,OAAO,CAAC,+BAA+B,EAAE,EAAE,CAAC,EACxD,QAAQ,CACT,CAAC,QAAQ,EAAE,CAAC;aACd;YACD,OAAO,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;SACjC;QACD,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC,CAAC;QAC1E,MAAM,QAAQ,GAAG,MAAM,QAAQ,EAAE,IAAI,CAAC;QACtC,OAAO,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,CAAC;IAC5C,CAAC;CACF\"}","dts":{"name":"/Users/kames/workspace/soulcialites/web3-citizen/packages/ens-wagmi/utils/specs/erc721.d.ts","writeByteOrderMark":false,"text":"import { BaseProvider } from '@ethersproject/providers';\r\nexport default class ERC721 {\r\n    getMetadata(provider: BaseProvider, ownerAddress: string | undefined | null, contractAddress: string, tokenID: string): Promise<any>;\r\n}\r\n"}}
